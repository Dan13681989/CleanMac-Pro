name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

permissions:
  contents: read

jobs:
  test:
    runs-on: macos-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup environment
      run: |
        chmod +x bin/*
        chmod +x tests/*
        
    - name: Run basic tests
      run: |
        ./tests/run-comprehensive-tests.sh
        
    - name: Check syntax
      run: |
        for file in bin/*; do
          bash -n "$file" || exit 1
        done
        echo "✅ All scripts have valid syntax"
        
    - name: Verify documentation
      run: |
        [ -f README.md ] && echo "✅ README exists"
        [ -f QUICK_START.md ] && echo "✅ Quick start exists"
        [ -f LICENSE ] && echo "✅ License exists"

  release:
    runs-on: macos-latest
    if: startsWith(github.ref, 'refs/tags/')
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Create release
      uses: softprops/action-gh-release@v1
      with:
        files: |
          bin/*
          LICENSE
          README.md
          QUICK_START.md
